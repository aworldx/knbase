---
title: Patterns
keywords: ruby
summary: "This is just a sample topic..."
sidebar: knbase_sidebar
permalink: ruby_patterns.html
folder: knbase
---

### Адаптер
Оборачиваем класс в адаптер, так чтобы он стал понятен другому обьекту

XmlToJsonAdapter

### Декоратор
Динамическое добавление функциональности с помощью оберток

Отличия от адаптера:
- адаптер меняет интерфейс объекта
- декоратор дополняет объект без изменения интерфейса
- адаптер предоставляет альтернативный интерфейс
- декоратор предоставляет расширенный интерфейс

### Фасад
Простой интерфейс для работы со сложной подсистемой содержащей множество классов

### Легковес
Не хранить в классе внешнее состояние, передавать его через параметры

### Компоновщик
Сгруппировать множество объектов в древовидную структуру и работать с ней так как будто это один объект

```
              продукт
             /
      коробка         продукт
     /       \       /
заказ         коробка 
                     \
                      продукт
```

### Заместитель
подставлять вместо реальных объектов специальные объекты заместители. Эти объекты перехыватывают вызовы к оригинальному объекту, позволяя сделать что-то до и после передачи вызова оригиналу.

### Стретагеия
Определить семейство сложных алгоритмов, которые часто изменяются или расширяются, и вынести их в собственные классы, называемые стратегиями. Изначальный класс будет играть роль контекста и делегировать работу стратегии.  
У всех стратегии должен быть общий интерфейс.

### Команда
Превращать запросы в объекты, передавать их как аргументы. Ставить запросы в очередь, логировать их, итд.

### Итератор
вынести поведение обхода коллекции из самой коллекции в отдельный класс

### Шаблонный метод
разбить алгоритм на несколько шагов, описать шаги в отдельных методах и вызвать их в одном шаблонном методе.
Подклассы могут переопределять некоторые шаги алгоритма.

## Rails patterns

### Value objects
- хранение констант или наборов констант в виде отдельных классов
- хранение сложных структурных констант
- переиспользование констант

### Service object
- программа делится на функциональные составляющие - сервисы
- каждый сервис делает одну задачу
- изоляция бизнес логики
- переиспользование сервисов

### Form object
- инкапсуляция обработки параметров формы, создания и обновления сущностей в одном классе FormObject
- переиспользование кода для разных моделей
- меньше кода в моделях и контроллерах

### Interactor
- разбить сложные алгоритм или процесс на отдельные шаги
- каждый шан описать отдельным классом
- организовать класс который поочередно вызывает эти шаги, и возвращает успех или сообщение ошибки
- можно переиспользовать шаги в разных интеракторах

### Observer
- позволяет рассылать сообщения о событиях подписчикам

### Query object
- убрать запросы из контроллеров
- переиспользование запросов
```
class PopularPostsQuery
  def call(relation)
    relation
      .where(type: :post)
      .where('view_count > ?', 100)
  end
end
```

### View object

### Policy object
- валидация моделей в отдельном классе
- авторизация доступа к ресурсам (pundit)

### Decorators

### Presenters
- переместить логику отображения из вьюхи (контроллера и модели) в отдельный класс

